data <- c(1:100)  #test dataset used to understand if the code is working

Leemis <- function(data){  #set up function for inputted data called Leemis
  temp <- as.numeric(substr(data, 1, 1)) #defined a vector, "temp," within the function. Temp is the first digit of each element of the inputted vector
  temp.table <- as.data.frame(table(temp)) #creates "temp.table," which is "temp" in the form a frequency table.
  freq <- temp.table$Freq/sum(temp.table$Freq) #defines freq as the proportion of occurences for each digit out of the whole population
  out <- numeric() #ouput will be numberic data
  for(j in 1:length(levels(temp.table$temp))){ #for loop that defines j as a number 1-9. Takes into account the possibility of a first digit 1-9 missing in the inputted vector.
    for(i in 1:9){ #i=1, i=2, etc
      if(as.numeric(levels(temp.table$temp)[j])==i){ #if there are no missing first digits 1-9, then continue
        out[i] <- freq[j] - log10(1+1/i) #Given Leemis equation
      }
    }
  }
  return(max(out)) #returns max value of the outputted vector
}

(Leemis(data)) #test is successful

ChoGains <- function(data){ #defines function as ChoGains, data is input)
  temp <- as.numeric(substr(data, 1, 1)) 
  temp.table <- as.data.frame(table(temp))
  freq <- temp.table$Freq/sum(temp.table$Freq)
  out <- numeric()
  for(j in 1:length(levels(temp.table$temp))){
    for(i in 1:9){
      if(as.numeric(levels(temp.table$temp)[j])==i){
        out[i] <- (freq[j] - log10(1+1/i))^2 #ChoGains function is the same as the Leemis equation except for this line, different equation
      }
    }
  }
  return(sqrt(sum(out))) #returns one number
}

ChoGains(data)

choose.function = function(input, data){ #choose.function has to two inputs, "input" and "data"
  if(input == "Leemis") {
    print(Leemis(data)) #if the input is "Leemis," then it will print the output of the Leemis function with the given data
  } else if (input == "ChoGains") {
    print(ChoGains(data)) #if the input is "ChoGains," then it will print the output of the ChoGain function with the given data
     } else{ (input == "Both") 
        print(c(Leemis(data), ChoGains(data))) #if the input is both or any other word, the outputs of both function will be printed
     }
  return()
}

choose.function("Leemis", data)
choose.function("ChoGains", data)
choose.function("Both", data) #tests successful

#2)

#making a function for activity four that returns significance

Leemis.sig= function(data) { #will return if leemis critical value is significant
   if (Leemis(data) >=.851 & Leemis(data) < .967) { #if critical value is between these .851 and .967, it's significant at .1
      print("Critical value is significant at .10")
    } else if (Leemis(data) >= .967 & Leemis(data) < 1.212) { 
      print("Critical value is significant at .05")
       } else if (Leemis(data) >= 1.212) 
         print("Critical value is significant at .01") 
            else (Leemis(data) < .851) #if critical value is less than .851, no significance
            print ("Critical value is not significant")
}
    

Leemis.sig(data) #test works



